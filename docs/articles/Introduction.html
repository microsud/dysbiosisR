<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dysbiosisR">
<title>Introduction • dysbiosisR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="dysbiosisR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dysbiosisR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction.html">Introduction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/microsud/dysbiosisR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/microsud/dysbiosisR/blob/HEAD/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<p>In human microbiome research, there is interest in measuring
“dysbiosis” which in many cases relies on comparing a case group with a
control (without known disease). Several methods have been reported in
literature and reviewed by Wei S et al., in their 2021 article <a href="https://doi.org/10.1128/AEM.00395-21" class="external-link">Determining gut microbial
dysbiosis: a review of applied indexes for assessment of intestinal
microbiota imbalances</a>. The <code>dysbiosisR</code> provides tools
for five approaches covering three different methods: Neighborhood
classification, Random forest prediction and Combined alpha-beta
diversity.</p>
<p>It is important to note that the term ‘dysbiosis’ is a vaguely
defined term in most instances and different methods are employed. We
noticed a lack of tools for convenient and reproducible measurement of
“dysbiosis” measures/scores/index. To address this gap we accumulated
some commonly used approaches into a more standardized manner in an R
package we call <code>dysbiosisR</code>.<br>
We would also like to direct the readers and users to debates
surrounding the concept of dysbiosis and suggest to interpret these
measures by considering its pitfalls.</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://sfamjournals.onlinelibrary.wiley.com/doi/full/10.1111/1751-7915.13479" class="external-link">Problems
with the concept of gut microbiota dysbiosis</a></p></li>
<li><p><a href="https://doi.org/10.1128%2FmBio.01492-17" class="external-link">Dysbiosis and
Its Discontents</a></p></li>
<li><p><a href="https://doi.org/10.1038/nmicrobiol.2016.228" class="external-link">Dysbiosis
is not an answer</a></p></li>
</ol>
<div class="section level2">
<h2 id="load-libraries">Load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microsud/dysbiosisR" class="external-link">dysbiosisR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://microbiome.github.io/microbiome" class="external-link">microbiome</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"WirbelJ_2018"</span><span class="op">)</span></span></code></pre></div>
<p>Print the available methods.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dysbiosisOverview.html">dysbiosisOverview</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; You are using dysbiosisR version: [1] '1.0.1'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Following score (s) are currently supported</span></span>
<span><span class="co">#&gt; 1. dysbiosisMedianCLV: Lloyd-Price J, Arze CAnanthakrishnan AN et al. (2019)</span></span>
<span><span class="co">#&gt; 2. euclideanDistCentroids: AlShawaqfeh MK et al. (2017)</span></span>
<span><span class="co">#&gt; 3. cloudStatistic: Montassier E et al. (2018)</span></span>
<span><span class="co">#&gt; 4. combinedShannonJSD: Santiago M et al. (2019)</span></span>
<span><span class="co">#&gt; 5. dysbiosisOBB: Saffouri GB, Shields-Cutler R et al. (2019)</span></span></code></pre></div>
<p>Here we use the test data from <a href="https://doi.org/10.1038/s41591-019-0406-6" class="external-link">Wirbel J et al.,
(2018)</a>. The data consists of CRC and controls samples.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WirbelJ_2018</span></span>
<span><span class="co">#&gt; phyloseq-class experiment-level object</span></span>
<span><span class="co">#&gt; otu_table()   OTU Table:         [ 530 taxa and 125 samples ]</span></span>
<span><span class="co">#&gt; sample_data() Sample Data:       [ 125 samples by 24 sample variables ]</span></span>
<span><span class="co">#&gt; tax_table()   Taxonomy Table:    [ 530 taxa by 6 taxonomic ranks ]</span></span>
<span><span class="co">#&gt; phy_tree()    Phylogenetic Tree: [ 530 tips and 529 internal nodes ]</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check first five sample sums</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_sums.html" class="external-link">sample_sums</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; CCMD11006829ST-21-0 CCMD12232071ST-21-0 CCMD13071240ST-21-0 CCMD13934959ST-21-0 </span></span>
<span><span class="co">#&gt;            99.83789            99.98053            99.92165            99.95711 </span></span>
<span><span class="co">#&gt; CCMD14479708ST-21-0 </span></span>
<span><span class="co">#&gt;            98.87883</span></span></code></pre></div>
<p>These are relative abundance data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html" class="external-link">sample_data</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span><span class="op">)</span><span class="op">$</span><span class="va">disease</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     CRC healthy </span></span>
<span><span class="co">#&gt;      60      65</span></span></code></pre></div>
<p>There are 60 CRC samples and 65 control/healthy samples.</p>
</div>
<div class="section level2">
<h2 id="dysbiosis-measures">Dysbiosis Measures<a class="anchor" aria-label="anchor" href="#dysbiosis-measures"></a>
</h2>
<div class="section level3">
<h3 id="dysbiosis-score-based-on-median-community-level-variation">Dysbiosis score based on median community level variation<a class="anchor" aria-label="anchor" href="#dysbiosis-score-based-on-median-community-level-variation"></a>
</h3>
<p>Calculates median variation in a given sample compared to a reference
sample group. Here will calculate median variation for a sample compared
to a reference sample set. The user can provide a custom distance
matrix. If the user provides a Bray-Curtis dissimilarity matrix, then
the resulting score is comparable to the ‘dysbiosis score’ reported in
<a href="https://www.nature.com/articles/s41586-019-1237-9" class="external-link">Lloyd-Price
J, Arze C, Ananthakrishnan AN et al. (2019)</a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist.mat</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html" class="external-link">distance</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>, <span class="st">"bray"</span><span class="op">)</span></span>
<span><span class="co"># get reference samples</span></span>
<span><span class="va">ref.samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_names-methods.html" class="external-link">sample_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>, </span>
<span>                                           <span class="va">disease</span> <span class="op">==</span> <span class="st">"healthy"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dysbiosis_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dysbiosisMedianCLV.html">dysbiosisMedianCLV</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>,</span>
<span>                                  dist_mat <span class="op">=</span> <span class="va">dist.mat</span>,</span>
<span>                                  reference_samples <span class="op">=</span> <span class="va">ref.samples</span><span class="op">)</span></span></code></pre></div>
<p>The original article identifies highly divergent samples from the
reference set using the 90th percentile of the dysbiosis score. This can
be identified using the <code>quantile</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dysbiosis_thres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dysbiosis_1</span>, <span class="va">disease</span> <span class="op">==</span> <span class="st">"CRC"</span><span class="op">)</span><span class="op">$</span><span class="va">score</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">normobiosis_thres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dysbiosis_1</span>, <span class="va">disease</span> <span class="op">==</span> <span class="st">"CRC"</span><span class="op">)</span><span class="op">$</span><span class="va">score</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dysbiosis_1</span> <span class="op">&lt;-</span> <span class="va">dysbiosis_1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>isDysbiostic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">score</span> <span class="op">&gt;=</span> <span class="va">dysbiosis_thres</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check in each group how many satisfy the threshold </span></span>
<span><span class="va">dysbiosis_1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">disease</span>, <span class="va">isDysbiostic</span><span class="op">)</span></span>
<span><span class="co">#&gt;   disease isDysbiostic  n</span></span>
<span><span class="co">#&gt; 1     CRC        FALSE 54</span></span>
<span><span class="co">#&gt; 2     CRC         TRUE  6</span></span>
<span><span class="co">#&gt; 3 healthy        FALSE 61</span></span>
<span><span class="co">#&gt; 4 healthy         TRUE  4</span></span></code></pre></div>
<p>Visualize Dysbiosis Score between CRC and healthy group.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosis.html">plotDysbiosis</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">dysbiosis_1</span>,</span>
<span>                    xvar<span class="op">=</span><span class="st">"disease"</span>,</span>
<span>                    yvar<span class="op">=</span><span class="st">"score"</span>,</span>
<span>                    colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRC<span class="op">=</span><span class="st">"brown3"</span>, healthy<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span>,</span>
<span>                    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">"Dysbiosis Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># order the data </span></span>
<span><span class="va">dysbiosis_1</span><span class="op">$</span><span class="va">disease</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dysbiosis_1</span><span class="op">$</span><span class="va">disease</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span>, <span class="st">"CRC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roc_1</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">dysbiosis_1</span><span class="op">$</span><span class="va">disease</span><span class="op">)</span>,</span>
<span>                   <span class="va">dysbiosis_1</span><span class="op">$</span><span class="va">score</span> ,</span>
<span>                   <span class="co">#direction= "&gt;",</span></span>
<span>                   plot<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   max.auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   print.auc<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
<p>The AUC for this approach is 0.6469.</p>
</div>
<div class="section level3">
<h3 id="dysbiosis-score-based-on-euclidean-distance-to-group-centroids">Dysbiosis score based on Euclidean distance to group centroids<a class="anchor" aria-label="anchor" href="#dysbiosis-score-based-on-euclidean-distance-to-group-centroids"></a>
</h3>
<p>Calculates difference in <code>euclidean distance (ED)</code> for a
sample to group centroids. For example, sample_1 to control centroid
minus sample_1 to case centroid. The user can provide a custom distance
matrix. This approach was used in <a href="https://doi.org/10.1093/femsec/fix136" class="external-link">AlShawaqfeh MK et
al. (2017)</a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dysbiosis_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/euclideanDistCentroids.html">euclideanDistCentroids</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>,</span>
<span>                                      dist_mat <span class="op">=</span> <span class="va">dist.mat</span>,</span>
<span>                                      use_squared <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                      group_col <span class="op">=</span> <span class="st">"disease"</span>,</span>
<span>                                      control_label <span class="op">=</span> <span class="st">"healthy"</span>,</span>
<span>                                      case_label <span class="op">=</span> <span class="st">"CRC"</span><span class="op">)</span></span>
<span><span class="va">dysbiosis_2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;                     CentroidDist_CRC CentroidDist_healthy CentroidDist_score</span></span>
<span><span class="co">#&gt; CCMD11006829ST-21-0        0.2912347            0.3684569         0.07722225</span></span>
<span><span class="co">#&gt; CCMD12232071ST-21-0        0.2744104            0.3415175         0.06710710</span></span>
<span><span class="co">#&gt; CCMD13071240ST-21-0        0.2172320            0.2697302         0.05249821</span></span></code></pre></div>
<p>Here, the <code>CentroidDist_score</code> can be used as a dysbiosis
score.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># order the data </span></span>
<span><span class="va">dysbiosis_2</span><span class="op">$</span><span class="va">disease</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dysbiosis_2</span><span class="op">$</span><span class="va">disease</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span>, <span class="st">"CRC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roc_2</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">dysbiosis_2</span><span class="op">$</span><span class="va">disease</span><span class="op">)</span>,</span>
<span>                   <span class="va">dysbiosis_2</span><span class="op">$</span><span class="va">CentroidDist_score</span> ,</span>
<span>                   <span class="co">#direction= "&gt;",</span></span>
<span>                   plot<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   max.auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   print.auc<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<p>The AUC for this approach is 0.797.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosis.html">plotDysbiosis</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">dysbiosis_2</span>,</span>
<span>                    xvar<span class="op">=</span><span class="st">"disease"</span>,</span>
<span>                    yvar<span class="op">=</span><span class="st">"CentroidDist_score"</span>,</span>
<span>                    colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRC<span class="op">=</span><span class="st">"brown3"</span>, healthy<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span>,</span>
<span>                    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">"Dysbiosis Score (Centroid)"</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="combined-alpha-beta-diveristy-based-score">Combined Alpha Beta Diveristy Based Score<a class="anchor" aria-label="anchor" href="#combined-alpha-beta-diveristy-based-score"></a>
</h3>
<p>The combined alpha-beta diversity approach was used by <a href="http://www.aimspress.com/article/10.3934/microbiol.2019.1.1" class="external-link">Santiago
M E et al. 2019</a>. This approach uses Shannon diversity as the alpha
diversity measure and Jensen–Shannon divergence as the beta diversity
measure. The score is mean difference of Shannon diversity between test
sample and all references samples multiplied by the mean JSD of the test
sample to all reference samples. When calculating this score for
reference samples, the sample being used is excluded from calculating
means for alpha and beta diversity.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dysbiosis_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combinedShannonJSD.html">combinedShannonJSD</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>,</span>
<span>                                  reference_samples <span class="op">=</span> <span class="va">ref.samples</span><span class="op">)</span></span>
<span><span class="va">dysbiosis_3</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;                     ShannonJSDScore   study_name          subject_id</span></span>
<span><span class="co">#&gt; CCMD11006829ST-21-0      0.19887588 WirbelJ_2018 CCMD11006829ST-21-0</span></span>
<span><span class="co">#&gt; CCMD12232071ST-21-0      0.07682596 WirbelJ_2018 CCMD12232071ST-21-0</span></span>
<span><span class="co">#&gt; CCMD13071240ST-21-0      0.19646724 WirbelJ_2018 CCMD13071240ST-21-0</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosis.html">plotDysbiosis</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">dysbiosis_3</span>,</span>
<span>                    xvar<span class="op">=</span><span class="st">"disease"</span>,</span>
<span>                    yvar<span class="op">=</span><span class="st">"ShannonJSDScore"</span>,</span>
<span>                    colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRC<span class="op">=</span><span class="st">"brown3"</span>, healthy<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span>,</span>
<span>                    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">"Shannon-JSD\nDysbiosis Score"</span><span class="op">)</span></span>
<span><span class="va">p4</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># order the data </span></span>
<span><span class="va">dysbiosis_3</span><span class="op">$</span><span class="va">disease</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dysbiosis_3</span><span class="op">$</span><span class="va">disease</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span>, <span class="st">"CRC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roc_3</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">dysbiosis_3</span><span class="op">$</span><span class="va">disease</span><span class="op">)</span>,</span>
<span>                   <span class="va">dysbiosis_3</span><span class="op">$</span><span class="va">ShannonJSDScore</span> ,</span>
<span>                   <span class="co">#direction= "&gt;",</span></span>
<span>                   plot<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   max.auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   print.auc<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
<p>The AUC for this approach is 0.582.</p>
</div>
<div class="section level3">
<h3 id="cloud-based-locally-linear-unbiased-dysbiosis-cloud-test">Cloud-based LOcally linear Unbiased Dysbiosis (CLOUD) test<a class="anchor" aria-label="anchor" href="#cloud-based-locally-linear-unbiased-dysbiosis-cloud-test"></a>
</h3>
<p>Cloud-based LOcally linear Unbiased Dysbiosis (CLOUD) test is a
non-parametric test and returns a measure of dysbiosis. The function was
adapted from the original article by <a href="https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-018-0514-4" class="external-link">Montassier
E et al. 2018</a>. Here, a user defines a set of reference samples from
which distance of every other sample is calculated. When calculating the
<code>CLOUD</code> stats the <em>k</em> is an important parameter
specified by argument <code>k_num</code>. By default we use a
conservative 80 percent of the samples in each group.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cloud.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cloudStatistic.html">cloudStatistic</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>,</span>
<span>                                dist_mat <span class="op">=</span> <span class="va">dist.mat</span>,</span>
<span>                                reference_samples <span class="op">=</span> <span class="va">ref.samples</span>,</span>
<span>                                ndim<span class="op">=</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>                                k_num<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">cloud.results</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;                         stats pvals  log2Stats   study_name          subject_id</span></span>
<span><span class="co">#&gt; CCMD10032470ST-11-0 0.6673767     1 -0.5834267 WirbelJ_2018 CCMD10032470ST-11-0</span></span>
<span><span class="co">#&gt; CCMD10191450ST-11-0 0.6603512     1 -0.5986947 WirbelJ_2018 CCMD10191450ST-11-0</span></span>
<span><span class="co">#&gt; CCMD11006829ST-21-0 0.8141492     1 -0.2966349 WirbelJ_2018 CCMD11006829ST-21-0</span></span></code></pre></div>
<p>Here, the <code>log2Stats</code> can be used as a dysbiosis
score.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># order the data </span></span>
<span><span class="va">cloud.results</span><span class="op">$</span><span class="va">disease</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cloud.results</span><span class="op">$</span><span class="va">disease</span>, </span>
<span>                                levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span>, <span class="st">"CRC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roc_4</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cloud.results</span><span class="op">$</span><span class="va">disease</span><span class="op">)</span>,</span>
<span>                   <span class="va">cloud.results</span><span class="op">$</span><span class="va">log2Stats</span> ,</span>
<span>                   <span class="co">#direction= "&gt;",</span></span>
<span>                   plot<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   max.auc.polygon<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   print.auc<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
<p>The AUC for this approach is 0.631.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosis.html">plotDysbiosis</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">cloud.results</span>,</span>
<span>                    xvar<span class="op">=</span><span class="st">"disease"</span>,</span>
<span>                    yvar<span class="op">=</span><span class="st">"log2Stats"</span>,</span>
<span>                    colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRC<span class="op">=</span><span class="st">"brown3"</span>, healthy<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span>,</span>
<span>                    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">"Dysbiosis CLOUD Score"</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="random-forest-prediction-based-score">Random Forest Prediction Based Score<a class="anchor" aria-label="anchor" href="#random-forest-prediction-based-score"></a>
</h3>
<p>The original article <a href="https://doi.org/10.1038/s41467-019-09964-7" class="external-link">Saffouri GB,
Shields-Cutler R et al. 2019</a> reported a Symptom Index abbreviated as
SI. In this approach the feature abundances are used for Random Forest
classification and the resulting out of bag (OOB) predicted probability
of being classified in disease group is considered as an SI or also
dysbiosis index. The <code>dysbiosisOBB</code> function in this package
allows for calculating this measure with some level of freedom of
<code>tuneRF</code> and random forest parameters via the
<code>randomForest</code> R package.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data are relative abundances summed to 100 or</span></span>
<span><span class="co"># near 100 val</span></span>
<span><span class="va">dysbiosis.oob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dysbiosisOBB.html">dysbiosisOBB</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>,</span>
<span>                              group_col <span class="op">=</span> <span class="st">"disease"</span>,</span>
<span>                              case_label <span class="op">=</span> <span class="st">"CRC"</span>,</span>
<span>                              seed_value <span class="op">=</span> <span class="fl">1235</span>,</span>
<span>                              add_tuneRF_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ntreeTry<span class="op">=</span><span class="fl">100</span>,</span>
<span>                                                       stepFactor<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>                                                       improve<span class="op">=</span><span class="fl">0.01</span>,</span>
<span>                                                       trace<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                                       dobest<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                              ntree <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                              plot_roc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; mtry = 23  OOB error = 20.8% </span></span>
<span><span class="co">#&gt; Searching left ...</span></span>
<span><span class="co">#&gt; mtry = 16    OOB error = 22.4% </span></span>
<span><span class="co">#&gt; -0.07692308 0.01 </span></span>
<span><span class="co">#&gt; Searching right ...</span></span>
<span><span class="co">#&gt; mtry = 34    OOB error = 19.2% </span></span>
<span><span class="co">#&gt; 0.07692308 0.01 </span></span>
<span><span class="co">#&gt; mtry = 51    OOB error = 17.6% </span></span>
<span><span class="co">#&gt; 0.08333333 0.01 </span></span>
<span><span class="co">#&gt; mtry = 76    OOB error = 18.4% </span></span>
<span><span class="co">#&gt; -0.04545455 0.01</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;"><img src="Introduction_files/figure-html/unnamed-chunk-19-2.png" width="100%" style="display: block; margin: auto;"></p>
<p>Visualize</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosis.html">plotDysbiosis</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">dysbiosis.oob</span>,</span>
<span>                    xvar<span class="op">=</span><span class="st">"disease"</span>,</span>
<span>                    yvar<span class="op">=</span><span class="st">"oob.score"</span>,</span>
<span>                    colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRC<span class="op">=</span><span class="st">"brown3"</span>, healthy<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span>,</span>
<span>                    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">"OOB Dysbiosis Score"</span><span class="op">)</span></span>
<span><span class="va">p5</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>All these measure may be influenced by host factors such as age,
gender, BMI, etc. It is advised to investigate these factors when
analyzing the dysbiosis measures.</p>
</div>
</div>
<div class="section level2">
<h2 id="gradient-plot">Gradient plot<a class="anchor" aria-label="anchor" href="#gradient-plot"></a>
</h2>
<p>Current dysbiosis measures do not necessarily reveal a yes and no
classification of healthy and disease states. This is a challenge in gut
microbiome research where individuality plays an important role. To
demonstrate this, we can visualize this gradient with
<code>plotDysbiosisGradient</code>. We use the results from the the
random forest prediction based score and <code>dysbiosisMedianCLV</code>
approach along with the <code>dysbiosis_thres</code> and
<code>normobiosis_thres</code> values we obtained above.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># define gradient cols</span></span>
<span><span class="co"># browns &lt;- c("#723d46", "#86525b", "#996770", "#ad7d86", </span></span>
<span><span class="co">#             "#c1949d", "#d6abb4", "#eac3cc", "#ede5e6")</span></span>
<span><span class="va">volcano</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#003f5c"</span>, <span class="st">"#58508d"</span>,<span class="st">"#bc5090"</span>,<span class="st">"#ff6361"</span>, <span class="st">"#ffa600"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># RF OOB  </span></span>
<span><span class="va">p.obb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosisGradient.html">plotDysbiosisGradient</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">dysbiosis.oob</span>,</span>
<span>                               score<span class="op">=</span><span class="st">"oob.score"</span>,</span>
<span>                               high_line <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                               <span class="co"># low_line = normobiosis_thres,</span></span>
<span>                               group_var <span class="op">=</span> <span class="st">"disease"</span>,</span>
<span>                               group_colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span> <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>                                              <span class="st">"CRC"</span><span class="op">=</span> <span class="st">"brown3"</span><span class="op">)</span>,</span>
<span>                               point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                               bg_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span>,</span>
<span>                               jitter_width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Dysbiosis Score"</span>, subtitle <span class="op">=</span> <span class="st">"RF OOB Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># adjust the x and y values to fit to plot</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.7</span>, y <span class="op">=</span> <span class="fl">0.55</span>,</span>
<span>                    label <span class="op">=</span> <span class="st">"OOB probability\n(0.5)"</span>, color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Median CLV    </span></span>
<span><span class="va">p.clv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDysbiosisGradient.html">plotDysbiosisGradient</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">dysbiosis_1</span>,</span>
<span>                               score<span class="op">=</span><span class="st">"score"</span>,</span>
<span>                               high_line <span class="op">=</span> <span class="va">dysbiosis_thres</span>,</span>
<span>                               low_line <span class="op">=</span> <span class="va">normobiosis_thres</span>,</span>
<span>                               group_var <span class="op">=</span> <span class="st">"disease"</span>,</span>
<span>                               group_colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span> <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>                                              <span class="st">"CRC"</span><span class="op">=</span> <span class="st">"brown3"</span><span class="op">)</span>,</span>
<span>                               point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                               bg_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span>,</span>
<span>                               jitter_width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Dysbiosis Score"</span>, subtitle <span class="op">=</span> <span class="st">"Median CLV"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># adjust the x and y values to fit to plot</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.6</span>, y <span class="op">=</span> <span class="va">dysbiosis_thres</span><span class="op">+</span><span class="fl">0.03</span>,</span>
<span>                    label <span class="op">=</span> <span class="st">"Dysbiosis\nThreshold"</span>, color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.65</span>, y <span class="op">=</span> <span class="va">normobiosis_thres</span><span class="op">-</span><span class="fl">0.03</span>,</span>
<span>                    label <span class="op">=</span> <span class="st">"Normobiosis\nThreshold"</span>, color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p>Combine the two plots using <code>patchwork</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">p.obb</span> <span class="op">+</span> <span class="va">p.clv</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-22-1.png" width="100%"></p>
<p>Additional notes: The ROC AUC curves generated for a single data set
are susceptible to over fitting or under fitting and therefore, the
dysbiosis scores should be considered to be data specific. In order to
build/use generalized prediction models based on dysbiosis measures and
inferred cut-offs, different training and test data must be used. We see
the application of these dysbiosis measure more specifically for single
data sets where one would like to ‘capture disease associated imbalance’
into a single sample specific score. This score may be used to check for
associations with other disease related features.</p>
<p>Caution: The dysbiosis score in itself does not tell anything about
the cause or consequence and hence careful interpretation is of
paramount importance.</p>
<p>Here, for example we ask how different is the gut microbiota at
different CRC stages compared to control gut microbiota? We can look at
two measures, alpha diversity and dysbiosis score in different CRC
stages.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get alpha diversity example Shannon diversity  </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html" class="external-link">sample_data</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span><span class="op">)</span><span class="op">$</span><span class="va">shannon</span> <span class="op">&lt;-</span> <span class="fu">microbiome</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbiome/man/diversity.html" class="external-link">diversity</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span>, <span class="st">"shannon"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">shannon.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbiome/man/meta.html" class="external-link">meta</a></span><span class="op">(</span><span class="va">WirbelJ_2018</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>crc.stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ajcc</span><span class="op">)</span>, <span class="st">"CTRL"</span>, <span class="va">ajcc</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>crc.stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">crc.stage</span>, levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL"</span>, <span class="st">"0"</span>, <span class="st">"i"</span>, <span class="st">"ii"</span>, <span class="st">"iii"</span>, <span class="st">"iv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">crc.stage</span>, <span class="va">shannon</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">disease</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">disease</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"CRC stages"</span>, y<span class="op">=</span><span class="st">"Shannon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span><span class="st">"Disease"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span> <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>                                           <span class="st">"CRC"</span><span class="op">=</span> <span class="st">"brown3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># random forest prediction based score  </span></span>
<span><span class="va">dys.plot</span> <span class="op">&lt;-</span> <span class="va">dysbiosis.oob</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>crc.stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ajcc</span><span class="op">)</span>, <span class="st">"CTRL"</span>, <span class="va">ajcc</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>crc.stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">crc.stage</span>, levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL"</span>, <span class="st">"0"</span>, <span class="st">"i"</span>, <span class="st">"ii"</span>, <span class="st">"iii"</span>, <span class="st">"iv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">crc.stage</span>, <span class="va">oob.score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">disease</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">disease</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"CRC stages"</span>, y<span class="op">=</span><span class="st">"Dysbiosis Score\n(RF OOB)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span><span class="st">"Disease"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span> <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>                                              <span class="st">"CRC"</span><span class="op">=</span> <span class="st">"brown3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">shannon.plot</span> <span class="op">+</span> <span class="va">dys.plot</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-23-1.png" width="100%"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.1 (2022-06-23 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Windows 10 x64 (build 19044)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_United States.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=English_United States.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_United States.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                          </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_United States.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] patchwork_1.1.2   dplyr_1.0.9       dysbiosisR_1.0.1  microbiome_1.18.0</span></span>
<span><span class="co">#&gt; [5] ggplot2_3.3.6     phyloseq_1.40.0  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] nlme_3.1-157           bitops_1.0-7           fs_1.5.2              </span></span>
<span><span class="co">#&gt;   [4] usedist_0.4.0          RColorBrewer_1.1-3     rprojroot_2.0.3       </span></span>
<span><span class="co">#&gt;   [7] GenomeInfoDb_1.32.2    tools_4.2.1            bslib_0.4.0           </span></span>
<span><span class="co">#&gt;  [10] utf8_1.2.2             R6_2.5.1               vegan_2.6-2           </span></span>
<span><span class="co">#&gt;  [13] ggdist_3.2.0           DBI_1.1.3              BiocGenerics_0.42.0   </span></span>
<span><span class="co">#&gt;  [16] mgcv_1.8-40            colorspace_2.0-3       permute_0.9-7         </span></span>
<span><span class="co">#&gt;  [19] rhdf5filters_1.8.0     ade4_1.7-19            withr_2.5.0           </span></span>
<span><span class="co">#&gt;  [22] tidyselect_1.1.2       compiler_4.2.1         textshaping_0.3.6     </span></span>
<span><span class="co">#&gt;  [25] cli_3.3.0              Biobase_2.56.0         desc_1.4.2            </span></span>
<span><span class="co">#&gt;  [28] labeling_0.4.2         sass_0.4.2             scales_1.2.1          </span></span>
<span><span class="co">#&gt;  [31] randomForest_4.7-1.1   pkgdown_2.0.6          systemfonts_1.0.4     </span></span>
<span><span class="co">#&gt;  [34] stringr_1.4.1          digest_0.6.29          rmarkdown_2.16        </span></span>
<span><span class="co">#&gt;  [37] XVector_0.36.0         pkgconfig_2.0.3        htmltools_0.5.3       </span></span>
<span><span class="co">#&gt;  [40] highr_0.9              fastmap_1.1.0          rlang_1.0.5           </span></span>
<span><span class="co">#&gt;  [43] rstudioapi_0.14        farver_2.1.1           jquerylib_0.1.4       </span></span>
<span><span class="co">#&gt;  [46] generics_0.1.3         jsonlite_1.8.0         distributional_0.3.1  </span></span>
<span><span class="co">#&gt;  [49] RCurl_1.98-1.6         magrittr_2.0.3         GenomeInfoDbData_1.2.8</span></span>
<span><span class="co">#&gt;  [52] biomformat_1.24.0      Matrix_1.5-1           Rcpp_1.0.8.3          </span></span>
<span><span class="co">#&gt;  [55] munsell_0.5.0          S4Vectors_0.34.0       Rhdf5lib_1.18.2       </span></span>
<span><span class="co">#&gt;  [58] fansi_1.0.3            ape_5.6-2              lifecycle_1.0.2       </span></span>
<span><span class="co">#&gt;  [61] pROC_1.18.0            stringi_1.7.6          yaml_2.3.5            </span></span>
<span><span class="co">#&gt;  [64] MASS_7.3-57            zlibbioc_1.42.0        rhdf5_2.40.0          </span></span>
<span><span class="co">#&gt;  [67] Rtsne_0.16             plyr_1.8.7             grid_4.2.1            </span></span>
<span><span class="co">#&gt;  [70] parallel_4.2.1         crayon_1.5.1           lattice_0.20-45       </span></span>
<span><span class="co">#&gt;  [73] Biostrings_2.64.0      splines_4.2.1          multtest_2.52.0       </span></span>
<span><span class="co">#&gt;  [76] knitr_1.40             pillar_1.8.1           igraph_1.3.1          </span></span>
<span><span class="co">#&gt;  [79] reshape2_1.4.4         codetools_0.2-18       stats4_4.2.1          </span></span>
<span><span class="co">#&gt;  [82] glue_1.6.2             evaluate_0.16          data.table_1.14.2     </span></span>
<span><span class="co">#&gt;  [85] vctrs_0.4.1            foreach_1.5.2          gtable_0.3.1          </span></span>
<span><span class="co">#&gt;  [88] purrr_0.3.4            tidyr_1.2.0            assertthat_0.2.1      </span></span>
<span><span class="co">#&gt;  [91] cachem_1.0.6           xfun_0.31              ragg_1.2.2            </span></span>
<span><span class="co">#&gt;  [94] survival_3.3-1         tibble_3.1.7           iterators_1.0.14      </span></span>
<span><span class="co">#&gt;  [97] memoise_2.0.1          IRanges_2.30.0         cluster_2.1.3         </span></span>
<span><span class="co">#&gt; [100] ellipsis_0.3.2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sudarshan Shetty.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
